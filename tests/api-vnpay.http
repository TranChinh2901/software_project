### ============================================
### VNPAY SANDBOX API TEST
### ============================================

### Biến môi trường
@baseUrl = http://localhost:4000/api/v1
@accessToken = eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6OSwiZW1haWwiOiJhZG1pbkBnbWFpbC5jb20iLCJyb2xlIjoiQURNSU4iLCJpYXQiOjE3NjUyOTE0NjksImV4cCI6MTc2NTI5MzI2OX0.Ym6gskQWb6qhFzmSPY9fljNlNk0Vd-s74fiw174-mro

### ============================================
### 1. TẠO URL THANH TOÁN VNPAY
### ============================================
### Cần đăng nhập trước để lấy access token
### Sau khi tạo order, gọi API này để lấy URL redirect đến VNPay

POST {{baseUrl}}/vnpay/create-payment-url
Content-Type: application/json
Authorization: Bearer {{accessToken}}

{
    "orderId": 1,
    "amount": 500000,
    "orderDescription": "Thanh toan don hang #1"
}

### ============================================
### 2. TEST RETURN URL (Sau khi thanh toán)
### ============================================
### URL này được VNPay redirect về sau khi thanh toán
### Thông thường không cần gọi trực tiếp

GET {{baseUrl}}/vnpay/return?vnp_Amount=50000000&vnp_BankCode=NCB&vnp_BankTranNo=VNP14614044&vnp_CardType=ATM&vnp_OrderInfo=Thanh+toan+don+hang&vnp_PayDate=20231209153000&vnp_ResponseCode=00&vnp_TmnCode=YOUR_TMN_CODE&vnp_TransactionNo=14614044&vnp_TransactionStatus=00&vnp_TxnRef=1&vnp_SecureHash=TEST_HASH

### ============================================
### 3. TEST IPN URL (Server-to-Server)
### ============================================
### VNPay server gọi endpoint này
### Không cần gọi trực tiếp

GET {{baseUrl}}/vnpay/ipn?vnp_Amount=50000000&vnp_BankCode=NCB&vnp_BankTranNo=VNP14614044&vnp_CardType=ATM&vnp_OrderInfo=Thanh+toan+don+hang&vnp_PayDate=20231209153000&vnp_ResponseCode=00&vnp_TmnCode=YOUR_TMN_CODE&vnp_TransactionNo=14614044&vnp_TransactionStatus=00&vnp_TxnRef=1&vnp_SecureHash=TEST_HASH

### ============================================
### HƯỚNG DẪN SỬ DỤNG
### ============================================
###
### FLOW THANH TOÁN VNPAY:
### 1. User tạo đơn hàng → POST /orders
### 2. Gọi API create-payment-url với orderId và amount
### 3. Redirect user đến paymentUrl trả về
### 4. User thanh toán trên VNPay
### 5. VNPay redirect về VNPAY_RETURN_URL
### 6. Backend xử lý và cập nhật trạng thái đơn hàng
###
### THẺ TEST VNPAY SANDBOX:
### - Số thẻ: 9704198526191432198
### - Tên chủ thẻ: NGUYEN VAN A
### - Ngày phát hành: 07/15
### - Mật khẩu OTP: 123456
###
### MÃ RESPONSE VNPAY:
### 00 - Giao dịch thành công
### 07 - Giao dịch bị nghi ngờ
### 09 - Thẻ chưa đăng ký Internet Banking
### 10 - Xác thực thông tin thẻ sai quá 3 lần
### 11 - Hết hạn chờ thanh toán
### 12 - Thẻ/Tài khoản bị khóa
### 13 - Sai mật khẩu OTP
### 24 - Khách hàng hủy giao dịch
### 51 - Tài khoản không đủ số dư
### 65 - Vượt quá hạn mức giao dịch
### 75 - Ngân hàng đang bảo trì
### 79 - Sai mật khẩu thanh toán quá số lần quy định
### 99 - Lỗi không xác định
